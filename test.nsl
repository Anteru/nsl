struct ApplicationToVertex
{
	float2 position : Position;
	float2 uv;
}

matrix4x4 worldViewProjection;
Texture2D tex;
Sampler2D sampler;

function FBar (float4 input) -> float4
{
	return FFoo (input);
}

function FFoo (float4 input) -> float4
{
	input *= 2;
	return input * 0.5;
}

struct UtilityStruct
{
	float4 member;
}

struct VertexToPixel
{
	float4 position : Position;
	float2 uv;
	float2 nestedArray[2][4];
}

shader(vertex) (ApplicationToVertex app2vs) -> VertexToPixel
{
	VertexToPixel result;
	UtilityStruct s;
	
	s.member = worldViewProjection * float4 (app2vs.position.xy, 0, 1);

	result.position = s.member;
	result.uv = app2vs.uv;

	return result;
}

struct FragmentOutput
{
	float4 color : ColorOutput[0];
}

shader(pixel) (VertexToPixel vs2ps) -> FragmentOutput
{
	FragmentOutput out;
	out.color = tex.Sample (sampler, float3(vs2ps.uv, 0)) * vs2ps.nestedArray[1][int(vs2ps.uv.x)].x;
	return out;
}
