struct TransformationMatrices
{
	uint valid;
	float4x4 matrices[3];
}

struct TransformInfo
{
	uint pointsToTransform;
	TransformationMatrices transforms[32];
}

float4 inputPositions[32];
float4 outputPositions[32];

function TransformPoint(float4 p, TransformationMatrices m) -> float4
{
	if (m.valid) {
		for (int i = 0; i < 3; ++i) {
			p = m.matrices[i] * p;
		}
	}

	return p;
}

function Transform(TransformInfo info)
{
	for (int i = 0; i < info.pointsToTransform; ++i) {
		outputPositions[i] = TransformPoint (inputPositions[i], info.transforms[i]);
	}
}
